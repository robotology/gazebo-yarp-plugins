# Copyright (C) 2015 iCub Facility
# Authors: Lorenzo Natale
# CopyPolicy: Released under the terms of the LGPLv2.1 or later, see LGPL.TXT


set(LIBRARY_TARGET_NAME gazebo_yarp_rpc_worldinterface)

yarp_idl_to_dir(INPUT_FILES worldinterface_rpc.thrift
                OUTPUT_DIR ${CMAKE_CURRENT_BINARY_DIR}/autogenerated
                SOURCES_VAR WIRPC_SRC
                HEADERS_VAR WIRPC_HEADERS
                INCLUDE_DIRS_VAR WIRPC_INCLUDES)

include_directories(${WIRPC_INCLUDES})
add_library(${LIBRARY_TARGET_NAME} SHARED ${WIRPC_SRC} ${WIRPC_HEADERS})
target_link_libraries(${LIBRARY_TARGET_NAME} ${YARP_LIBRARIES})

set_target_properties(${LIBRARY_TARGET_NAME} PROPERTIES VERSION ${${PROJECT_NAME}_VERSION}
                                                        PUBLIC_HEADER "${WIRPC_HEADERS}")

target_include_directories(${LIBRARY_TARGET_NAME} PUBLIC
                           "$<BUILD_INTERFACE:${WIRPC_INCLUDES}>"
                           "$<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/gazebo>")

set_property(TARGET ${LIBRARY_TARGET_NAME} PROPERTY PUBLIC_HEADER ${WIRPC_HEADERS})

install(TARGETS ${LIBRARY_TARGET_NAME}
        EXPORT ${PROJECT_NAME}
        RUNTIME DESTINATION "${CMAKE_INSTALL_BINDIR}"
        LIBRARY DESTINATION "${CMAKE_INSTALL_LIBDIR}"
        PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}/gazebo")

set_property(GLOBAL APPEND PROPERTY ${PROJECT_NAME}_TARGETS ${LIBRARY_TARGET_NAME})
